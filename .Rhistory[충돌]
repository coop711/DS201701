class_roll <- read.xlsx("../data/class_roll.xlsx", 1, startRow = 2, endRow = 23, colIndex = c(3:7, 9), colClasses = rep("character", 6), stringsAsFactors = FALSE)
str(class_roll)
names(class_roll) <- c("dept", "id", "name", "year", "e.mail", "cell.no")
setwd("~/Google 드라이브/Works/Class/Data_Science/R.WD/DS201701/R")
class_roll <- read.xlsx("../data/class_roll0303.xlsx", 1, startRow = 2, endRow = 162, colIndex = c(3:7, 9), colClasses = rep("character", 6), encoding = "UTF-8", stringsAsFactors = FALSE)
knitr::opts_chunk$set(echo = TRUE)
# install.packages("kable", repos = "https://cran.rstudio.com")
# install.packages("xlsx", repos = "https://cran.rstudio.com")
library(xlsx)
library(knitr)
# kableOptions('table.split.table', Inf)
class_roll <- read.xlsx("../data/class_roll0303.xlsx", 1, startRow = 2, endRow = 162, colIndex = c(3:7, 9), colClasses = rep("character", 6), encoding = "UTF-8", stringsAsFactors = FALSE)
names(class_roll) <- c("dept", "id", "name", "year", "e.mail", "cell.no")
knitr::opts_chunk$set(echo = TRUE)
# install.packages("kable", repos = "https://cran.rstudio.com")
# install.packages("xlsx", repos = "https://cran.rstudio.com")
library(xlsx)
library(knitr)
# kableOptions('table.split.table', Inf)
class_roll <- read.xlsx("../data/class_roll0303.xlsx", 1, startRow = 2, endRow = 162, colIndex = c(3:7, 9), colClasses = rep("character", 6), encoding = "UTF-8", stringsAsFactors = FALSE)
names(class_roll) <- c("dept", "id", "name", "year", "e.mail", "cell.no")
class_roll$name[class_roll$name == "정결"] <- "정결군"
names.split <- sapply(class_roll$name, function(x) unlist(strsplit(x, split ="")))
names.split[2:3, ] <- rep("ㅇ", 2)
class_roll$name <- apply(names.split, 2, paste, collapse = "")
write.table(class_roll, file ="../data/class_roll_masked.txt")
cell_no.split <- sapply(class_roll$cell.no, function(x) unlist(strsplit(x, split ="-")))
cell_no.split
cell_no.split <- sapply(class_roll$cell.no, function(x) unlist(strsplit(x, split ="-")))
cell_no.split
cell_no.split[3, ] <- "xxxx"
class_roll$cell.no <- apply(cell_no.split, 2, paste, collapse = "")
write.table(class_roll, file ="../data/class_roll_masked.txt")
cell_no.split
source('~/Google 드라이브/Works/Class/Data_Science/R.WD/DS201701/R/poll.R', echo=TRUE)
party <- c("더불어민주당", "자유한국당", "국민의당", "바른정당", "정의당", "기타정당", "없음/모름/무응답")
counts <- c(396, 109, 97, 51, 51, 29, 267)
prop.in <- c(20.0, 0.0, 2.7, 5.7, 29.5, 11.4, 2.3)
counts.in <- round(counts * prop.in / 100)
counts.not <- counts - counts.in
counts.df <- data.frame(지지정당 = party, 사례수 = counts, 참여 = counts.in, 미참여 = counts.not)
barplot(t(as.matrix(counts.df[, 3:4])), axes = FALSE, beside = FALSE, names.arg = counts.df[, 1], legend.text = c("참여", "미참여"), col = c("cyan", "red"))
party <- c("더불어민주당", "자유한국당", "국민의당", "바른정당", "정의당", "기타정당", "없음/모름/무응답")
counts <- c(396, 109, 97, 51, 51, 29, 267)
prop.in <- c(20.0, 0.0, 2.7, 5.7, 29.5, 11.4, 2.3)
counts.in <- round(counts * prop.in / 100)
counts.not <- counts - counts.in
counts.df <- data.frame(지지정당 = party, 사례수 = counts, 참여 = counts.in, 미참여 = counts.not)
par(family = "HCR Dotum LVT")
barplot(t(as.matrix(counts.df[, 3:4])), axes = FALSE, beside = FALSE, names.arg = counts.df[, 1], legend.text = c("참여", "미참여"), col = c("cyan", "red"))
axis(side = 2, at = counts, labels = counts)
main.title <- "지지정당 별 민주당 경선 참여 비교"
sub.title <- "JTBC 뉴스룸, 한국리서치 2017. 3. 14"
main.text <- "더불어민주당 지지자 중 20%,\n 정의당 지지자 중 29.5%,\n 더불어민주당 경선 참여"
title(main = main.title, cex.main = 2)
text(4, 250, main.text)
setwd("~/Google 드라이브/Works/Class/Data_Science/R.WD/DS201701/R")
library(extrafont)
library(extrafont)
candidates <- c("문재인", "안철수", "안희정", "이재명", "홍준표", "김진태", "심상정", "유승민")
rates <- c(35.2, 17.4, 12.0, 9.5, 7.7, 5.3, 3.4, 2.6)
party <- c("더불어민주당", "자유한국당", "국민의당", "정의당", "바른정당")
colour.party <- c("blue", "lightgrey", "darkgreen", "purple", "darkblue")
candidates.party <-  c("더불어민주당", "국민의당", "더불어민주당",  "더불어민주당", "자유한국당", "자유한국당", "정의당", "바른정당")
match(candidates.party, party)
candidates.colour <- colour.party[match(candidates.party, party)]
c.rates <- format(rates, nsmall = 1, justify = "right")
a <- sapply(strsplit(c.rates, "[.]"), `[`, 1)
b <- sapply(strsplit(c.rates, "[.]"), `[`, 2)
b.perc <- paste(".", b, "%", sep = "")
col.rates <- c("red", "orange", rep("darkblue", 6))
barplot(rates)
par(family = "HCR Dotum LVT")
b1 <- barplot(rates,
axes = FALSE,
col = "dodgerblue",
names.arg = candidates,
cex.names = 1.2,
ylim = c(0, 38))
library(extrafont)
fonts()
library(extrafont)
candidates <- c("문재인", "안철수", "안희정", "이재명", "홍준표", "김진태", "심상정", "유승민")
rates <- c(35.2, 17.4, 12.0, 9.5, 7.7, 5.3, 3.4, 2.6)
party <- c("더불어민주당", "자유한국당", "국민의당", "정의당", "바른정당")
colour.party <- c("blue", "lightgrey", "darkgreen", "purple", "darkblue")
candidates.party <-  c("더불어민주당", "국민의당", "더불어민주당",  "더불어민주당", "자유한국당", "자유한국당", "정의당", "바른정당")
match(candidates.party, party)
candidates.colour <- colour.party[match(candidates.party, party)]
c.rates <- format(rates, nsmall = 1, justify = "right")
a <- sapply(strsplit(c.rates, "[.]"), `[`, 1)
b <- sapply(strsplit(c.rates, "[.]"), `[`, 2)
b.perc <- paste(".", b, "%", sep = "")
col.rates <- c("red", "orange", rep("darkblue", 6))
barplot(rates)
par(family = "HCR Dotum LVT")
b1 <- barplot(rates,
axes = FALSE,
col = "dodgerblue",
names.arg = candidates,
cex.names = 1.2,
ylim = c(0, 38))
b1 <- barplot(rates,
axes = FALSE,
col = "dodgerblue",
names.arg = NULL,
cex.names = 1.2,
ylim = c(0, 38))
mtext(side = 1, at = b1, line = 0, text = candidates)
text(x = b1, y = rates + rep(1.5, 8),
labels = paste(rates, "%", sep = ""),
col = col.rates,
cex = 1.2)
main.title <- "대선주자 지지도"
note.text <- "조사기관:리얼미터, 총응답자:전국 성인 1,525명, 응답률:9.5%, 표준오차:95%신뢰수준 2.5%,
조사방법:유선 ARS 10%, 무선 ARS 71%, 무선전화면접 19%, 조사기간:2017년 3월27일(월)~29일(수)"
title(main = main.title, cex.main = 1.5, line = -2)
b1 <- barplot(rates,
axes = FALSE,
col = "dodgerblue",
names.arg = NULL,
cex.names = 1.2,
ylim = c(0, 38))
mtext(side = 1, at = b1, line = 0, text = candidates)
text(x = b1 - c(rep(0.4, 3), rep(0.3, 5)), y = rates + rep(1.5, 8),
labels = a,
col = col.rates,
cex = 1.6)
text(x = b1 + 0.2, y = rates + rep(1.5, 8),
labels = b.perc,
col = col.rates,
cex = 1.2)
rect(xleft = mean(b1) - 2, ybottom = max(rates) - 6, xright = mean(b1) + 2,
ytop = max(rates), col = "dodgerblue4")
text(x = mean(b1), y = max(rates) - 3, labels = main.title, col = "white", cex = 1.5)
text(x = mean(b1) - 2, y = max(rates) - 8, labels = note.text, cex = 0.5, adj = 0)
library(ggplot2)
candidates.f <- factor(candidates, levels = candidates)
rates.df <- data.frame(후보 = candidates.f,
정당 = candidates.party,
색깔 = candidates.colour,
지지도 = rates)
g0 <- ggplot(data = rates.df,
mapping = aes(x = 후보, y = 지지도))
(g1 <- g0 +
geom_bar(stat = "identity", fill = "dodgerblue"))
(g1.1 <- g0 +
geom_bar(stat = "identity",
fill = candidates.colour))
(g2 <- g1 +
theme_bw(base_family = "HCR Dotum LVT"))
(g3.0 <- g2 +
geom_text(mapping = aes(x = 후보,
y = 지지도 + rep(1, 8),
label = paste(지지도, "%", sep = "")),
size = 6))
(g3 <- g2 +
geom_text(mapping = aes(x = 후보,
y = 지지도 + rep(1, 8),
label = a),
hjust = 1,
size = 8,
colour = col.rates) +
geom_text(mapping = aes(x = 후보,
y = 지지도 + rep(1, 8),
label = b.perc),
hjust = 0,
size = 5,
colour = col.rates))
(g4 <- g3 +
labs(title = main.title))
(g5 <- g4 +
theme(plot.title = element_text(hjust = 0.5)))
(g6 <- g5 +
scale_y_continuous(breaks = rates, labels = rates))
(g7 <- g6 +
theme(panel.border = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_blank(),
axis.ticks = element_blank(),
axis.text.y = element_blank()))
(g8 <- g7 +
geom_text(mapping = aes(x = 후보,
y = -1,
label = 후보),
size = 5,
family = "HCR Dotum LVT"))
(g9 <- g8 +
ggtitle("") +
annotate("text",
x = mean(b1),
y = max(rates) - 3,
label = main.title,
vjust = 0,
size = 10,
family = "HCR Dotum LVT"))
(g9.1 <- g8 +
ggtitle("") +
geom_label(mapping = aes(x = mean(b1),
y = max(rates) - 3,
label = main.title),
label.padding = unit(0.9, "lines"),
size = 10,
fill = "dodgerblue4",
colour = "white",
family = "HCR Dotum LVT"))
(g9.2 <- g9.1 +
annotate("text", x = mean(b1) - 1, y = max(rates) - 8,
label = note.text,
size = 2,
hjust = 0))
(g9.2 <- g9.1 +
annotate("text", x = mean(b1) - 1, y = max(rates) - 8,
label = note.text,
size = 2,
hjust = 0))
(g9.2 <- g9.1 +
annotate("text", x = mean(b1) - 1, y = max(rates) - 8,
label = note.text,
size = 2,
hjust = 0,
family = "HCR Dotum LVT"))
knitr::opts_chunk$set(echo = TRUE)
library(xlsx)
library(pander)
library(knitr)
panderOptions('table.split.table', Inf)
panderOptions('table.alignment.rownames', 'left')
panderOptions('table.alignment.default', 'right')
options(width=180)
# panderOptions('digits', 3)
midterm[, c(1:3, 5:39)] <- sapply(midterm[, c(1:3, 5:39)], function(x) factor(midterm$x), levels = 1:4, labels = c("가", "나", "다", "라")))
midterm[, c(1:3, 5:39)] <- sapply(midterm[, c(1:3, 5:39)], function(x) factor(midterm$x, levels = 1:4, labels = c("가", "나", "다", "라")))
knitr::opts_chunk$set(echo = TRUE)
library(xlsx)
library(pander)
library(knitr)
panderOptions('table.split.table', Inf)
panderOptions('table.alignment.rownames', 'left')
panderOptions('table.alignment.default', 'right')
options(width=180)
# panderOptions('digits', 3)
midterm.roll <- read.xlsx("../data/SM_midterm.xlsx", 1, startRow = 3, endRow  = 32, colIndex = c(3:7, 9:42), colClasses = c(rep("character", 39)), header = FALSE, stringsAsFactors = FALSE)
names(midterm.roll) <- c("dept", "id", "name", "year", "e.mail", "cell.no", paste("Q", 1:33, sep = ""))
kable(head(midterm.roll[, 1:6]))
kable(head(midterm.roll[, 7:23]))
kable(head(midterm.roll[, 24:39]))
str(midterm.roll)
midterm <- midterm.roll[, c(7:39)]
kable(midterm)
midterm[, c(1:3, 5:39)] <- sapply(midterm[, c(1:3, 5:39)], function(x) factor(midterm$x, levels = 1:4, labels = c("가", "나", "다", "라")))
midterm[, c(1:3, 5:33)] <- sapply(midterm[, c(1:3, 5:33)], function(x) factor(midterm$x, levels = 1:4, labels = c("가", "나", "다", "라")))
midterm
midterm[c(1:3, 5:33)] <- sapply(midterm[c(1:3, 5:33)], function(x) factor(midterm$x, levels = 1:4, labels = c("가", "나", "다", "라")))
midterm
sapply(midterm[c(1:3], function(x) factor(x, levels = 1:4, labels = c("가", "나", "다", "라")))
sapply(midterm[c(1:3)], function(x) factor(x, levels = 1:4, labels = c("가", "나", "다", "라")))
midterm[1:3]
midterm.roll <- read.xlsx("../data/SM_midterm.xlsx", 1, startRow = 3, endRow  = 32, colIndex = c(3:7, 9:42), colClasses = c(rep("character", 39)), header = FALSE, stringsAsFactors = FALSE)
setwd("~/Google 드라이브/Works/Class/Data_Science/R.WD/DS201701/R")
midterm.roll <- read.xlsx("../data/SM_midterm.xlsx", 1, startRow = 3, endRow  = 32, colIndex = c(3:7, 9:42), colClasses = c(rep("character", 39)), header = FALSE, stringsAsFactors = FALSE)
names(midterm.roll) <- c("dept", "id", "name", "year", "e.mail", "cell.no", paste("Q", 1:33, sep = ""))
kable(head(midterm.roll[, 1:6]))
kable(head(midterm.roll[, 7:23]))
kable(head(midterm.roll[, 24:39]))
str(midterm.roll)
midterm <- midterm.roll[, c(7:39)]
kable(midterm)
midterm[midterm == "1"] <- "가"
midterm[midterm == "2"] <- "나"
midterm[midterm == "3"] <- "다"
midterm[midterm == "4"] <- "라"
midterm$Q4 <- tolower(midterm$Q4)
na.index <- which(is.na(midterm$Q4))
midterm$Q4[na.index] <- "9999"
q4.split <- sapply(midterm$Q4, function(x) unlist(strsplit(x, split = "")))
Q4_m <- t(q4.split)
rownames(Q4_m) <- NULL
colnames(Q4_m) <- paste("Q4", 1:4, sep = ".")
Q4_m[Q4_m == "9"] <- NA
Q4_m
SM_midterm <- data.frame(midterm[, 1:3], Q4_m, midterm[, -(1:4)], row.names = NULL, stringsAsFactors = FALSE)
pander(SM_midterm)
midterm.roll <- read.xlsx("../data/SM_midterm.xlsx", 1, startRow = 3, endRow  = 32, colIndex = c(3:7, 9:42), colClasses = c(rep("character", 39)), header = FALSE, stringsAsFactors = FALSE)
names(midterm.roll) <- c("dept", "id", "name", "year", "e.mail", "cell.no", paste("Q", 1:33, sep = ""))
kable(head(midterm.roll[, 1:6]))
kable(head(midterm.roll[, 7:23]))
kable(head(midterm.roll[, 24:39]))
str(midterm.roll)
midterm <- midterm.roll[, c(7:39)]
kable(midterm)
midterm$Q4 <- tolower(midterm$Q4)
na.index <- which(is.na(midterm$Q4))
midterm$Q4[na.index] <- "9999"
q4.split <- sapply(midterm$Q4, function(x) unlist(strsplit(x, split = "")))
Q4_m <- t(q4.split)
rownames(Q4_m) <- NULL
colnames(Q4_m) <- paste("Q4", 1:4, sep = ".")
Q4_m[Q4_m == "9"] <- NA
data.frame(Q4_m)
str(midterm[, 1:3])
str(midterm[1:3])
str(midterm[[1:3]])
str(midterm[[1:2]])
midterm.roll <- read.xlsx("../data/SM_midterm.xlsx", 1, startRow = 3, endRow  = 32, colIndex = c(3:7, 9:42), colClasses = c(rep("character", 39)), header = FALSE)
names(midterm.roll) <- c("dept", "id", "name", "year", "e.mail", "cell.no", paste("Q", 1:33, sep = ""))
kable(head(midterm.roll[, 1:6]))
kable(head(midterm.roll[, 7:23]))
kable(head(midterm.roll[, 24:39]))
str(midterm.roll)
midterm <- midterm.roll[, c(7:39)]
kable(midterm)
midterm.roll <- read.xlsx("../data/SM_midterm.xlsx", 1, startRow = 3, endRow  = 32, colIndex = c(3:7, 9:42), colClasses = c(rep("character", 39)), header = FALSE, stringsAsFactors = FALSE)
names(midterm.roll) <- c("dept", "id", "name", "year", "e.mail", "cell.no", paste("Q", 1:33, sep = ""))
kable(head(midterm.roll[, 1:6]))
kable(head(midterm.roll[, 7:23]))
kable(head(midterm.roll[, 24:39]))
str(midterm.roll)
midterm <- midterm.roll[, c(7:39)]
kable(midterm)
midterm[, c(1:3, 5:33)]
str(midterm[, c(1:3, 5:33)])
midterm[, c(1:3, 5:33)] <- sapply(midterm[, c(1:3, 5:33)], function(x) factor(x, levels = 1:4, labels = c("가", "나", "다", "리")))
str(midterm)
str(sapply(midterm[, c(1:3, 5:33)], function(x) factor(x, levels = 1:4, labels = c("가", "나", "다", "리"))))
sapply(midterm[, c(1:3, 5:33)], function(x) factor(x, levels = 1:4, labels = c("가", "나", "다", "리")))
sapply(midterm[, c(1:3, 5:33)], factor(x, levels = 1:4, labels = c("가", "나", "다", "리")))
sapply(midterm[, c(1:3, 5:33)], factor, levels = 1:4, labels = c("가", "나", "다", "리"))
sapply(midterm[c(1:3, 5:33)], factor, levels = 1:4, labels = c("가", "나", "다", "리"))
midterm
str(midterm)
sapply(midterm[c(1:3)], factor, labels = 1:4))
sapply(midterm[c(1:3)], factor, labels = 1:4)
sapply(midterm[c(1:3)], factor, levels = c("가", "나", "다", "라"), labels = 1:4)
midterm.roll <- read.xlsx("../data/SM_midterm.xlsx", 1, startRow = 3, endRow  = 32, colIndex = c(3:7, 9:42), colClasses = c(rep("character", 39)), header = FALSE, stringsAsFactors = FALSE)
names(midterm.roll) <- c("dept", "id", "name", "year", "e.mail", "cell.no", paste("Q", 1:33, sep = ""))
kable(head(midterm.roll[, 1:6]))
kable(head(midterm.roll[, 7:23]))
kable(head(midterm.roll[, 24:39]))
str(midterm.roll)
midterm <- midterm.roll[, c(7:39)]
kable(midterm)
sapply(midterm[c(1:3)], factor, levels = 1:4, labels = c("가", "나", "다", "라")))
sapply(midterm[c(1:3)], factor, levels = 1:4, labels = c("가", "나", "다", "라"))
midterm.roll <- read.xlsx("../data/SM_midterm.xlsx", 1, startRow = 3, endRow  = 32, colIndex = c(3:7, 9:42), colClasses = c(rep("character", 39)), header = FALSE, stringsAsFactors = FALSE)
names(midterm.roll) <- c("dept", "id", "name", "year", "e.mail", "cell.no", paste("Q", 1:33, sep = ""))
kable(head(midterm.roll[, 1:6]))
kable(head(midterm.roll[, 7:23]))
kable(head(midterm.roll[, 24:39]))
str(midterm.roll)
midterm <- midterm.roll[, c(7:39)]
kable(midterm)
sapply(midterm[c(1:3, 5:33)], factor, levels = 1:4, labels = c("가", "나", "다", "라"))
str(sapply(midterm[c(1:3, 5:33)], factor, levels = 1:4, labels = c("가", "나", "다", "라")))
str(sapply(midterm[c(1:3, 5:33)], as.factor, levels = 1:4, labels = c("가", "나", "다", "라")))
str(lapply(midterm[c(1:3, 5:33)], factor, levels = 1:4, labels = c("가", "나", "다", "라")))
str(sapply(midterm[c(1:3, 5:33)], factor, levels = 1:4, labels = c("가", "나", "다", "라")))
factor(c(1:3, 5)) == c(1:3, 5)
?`==`
midterm[, c(1:3, 5:33)] <- lapply(midterm[, c(1:3, 5:33)], function(x) factor, levels = 1:4, labels = c("가", "나", "다", "리"))
midterm.roll <- read.xlsx("../data/SM_midterm.xlsx", 1, startRow = 3, endRow  = 32, colIndex = c(3:7, 9:42), colClasses = c(rep("character", 39)), header = FALSE, stringsAsFactors = FALSE)
names(midterm.roll) <- c("dept", "id", "name", "year", "e.mail", "cell.no", paste("Q", 1:33, sep = ""))
kable(head(midterm.roll[, 1:6]))
kable(head(midterm.roll[, 7:23]))
kable(head(midterm.roll[, 24:39]))
str(midterm.roll)
midterm <- midterm.roll[, c(7:39)]
kable(midterm)
midterm$Q4 <- tolower(midterm$Q4)
na.index <- which(is.na(midterm$Q4))
midterm$Q4[na.index] <- "9999"
q4.split <- sapply(midterm$Q4, function(x) unlist(strsplit(x, split = "")))
Q4_m <- t(q4.split)
rownames(Q4_m) <- NULL
colnames(Q4_m) <- paste("Q4", 1:4, sep = ".")
Q4_m[Q4_m == "9"] <- NA
Q4_m <- data.frame(Q4_m)
midterm[, c(1:3, 5:33)] <- lapply(midterm[, c(1:3, 5:33)], function(x) factor, levels = 1:4, labels = c("가", "나", "다", "리"))
midterm[, c(1:3, 5:33)] <- lapply(midterm[, c(1:3, 5:33)], factor, levels = 1:4, labels = c("가", "나", "다", "리"))
str(midterm)
SM_midterm <- data.frame(midterm[, 1:3], Q4_m, midterm[, -(1:4)], row.names = NULL, stringsAsFactors = FALSE)
pander(SM_midterm)
str(SM_midterm)
midterm.roll <- read.xlsx("../data/SM_midterm.xlsx", 1, startRow = 3, endRow  = 32, colIndex = c(3:7, 9:42), colClasses = c(rep("character", 39)), header = FALSE, stringsAsFactors = FALSE)
names(midterm.roll) <- c("dept", "id", "name", "year", "e.mail", "cell.no", paste("Q", 1:33, sep = ""))
kable(head(midterm.roll[, 1:6]))
kable(head(midterm.roll[, 7:23]))
kable(head(midterm.roll[, 24:39]))
str(midterm.roll)
midterm <- midterm.roll[, c(7:39)]
kable(midterm)
midterm$Q4 <- tolower(midterm$Q4)
na.index <- which(is.na(midterm$Q4))
midterm$Q4[na.index] <- "9999"
q4.split <- sapply(midterm$Q4, function(x) unlist(strsplit(x, split = "")))
Q4_m <- t(q4.split)
rownames(Q4_m) <- NULL
colnames(Q4_m) <- paste("Q4", 1:4, sep = ".")
Q4_m[Q4_m == "9"] <- NA
Q4_m <- lapply(Q4_m, factor, levels = c("a", "b", "c", "d"))
midterm[, c(1:3, 5:33)] <- lapply(midterm[, c(1:3, 5:33)], factor, levels = 1:4, labels = c("가", "나", "다", "리"))
str(midterm)
SM_midterm <- data.frame(midterm[, 1:3], Q4_m, midterm[, -(1:4)], row.names = NULL, stringsAsFactors = FALSE)
str(SM_midterm)
Q4_m <- lapply(Q4_m, factor, levels = c("a", "b", "c", "d"))
str(Q4_m)
midterm$Q4 <- tolower(midterm$Q4)
na.index <- which(is.na(midterm$Q4))
midterm$Q4[na.index] <- "9999"
q4.split <- sapply(midterm$Q4, function(x) unlist(strsplit(x, split = "")))
Q4_m <- t(q4.split)
rownames(Q4_m) <- NULL
colnames(Q4_m) <- paste("Q4", 1:4, sep = ".")
Q4_m[Q4_m == "9"] <- NA
Q4_m <- lapply(data.frame(Q4_m), factor, levels = c("a", "b", "c", "d"))
str(Q4_m)
?split
?as.matrix
?table
?barplot
?text
kable(SM_midterm[1:18])
kable(SM_midterm[19:36])
pander(t(sapply(SM_midterm, table)))
SM_midterm.tbl <- t(sapply(SM_midterm, table, useNA = "no"))
kable(SM_midterm.tbl)
SM_midterm.tbl <- t(sapply(SM_midterm, table, useNA = "no"))
kable(SM_midterm.tbl)
SM_midterm.tbl <- sapply(SM_midterm, table, useNA = "no")
SM_midterm.ptbl <- round(apply(SM_midterm.tbl, 2, prop.table) * 100, digits = 2)
SM_midter.ptbl
SM_midterm.ptbl
SM_midterm.ptbl <- round(apply(SM_midterm.tbl, 2, prop.table) * 100, digits = 0)
SM_midterm.ptbl
label.ptbl <- paste(format(SM_midterm.ptbl, digits = 2, nsmall = 1), "%", sep ="")
as.data.frame()
as.data.frame
?as.data.frame
par(family = "HCR Dotum LVT", mar = c(5.1, 4.1, 4.1, 8.1), xpd = TRUE)
SM_midterm.tbl <- sapply(SM_midterm, table, useNA = "no")
str(SM_midterm.tbl)
SM_midterm.ptbl <- round(apply(SM_midterm.tbl, 2, prop.table) * 100, digits = 0)
SM_midterm.ptbl
label.ptbl <- matrix(paste(format(SM_midterm.ptbl, digits = 2, nsmall = 0), "%", sep =""), nrow = 4)
label.ptbl <- ifelse(label.ptbl == "  0%", "", label.ptbl)
label.ptbl[, 1:10]
kable(SM_midterm.tbl)
b <- barplot(matrix(SM_midterm.tbl, nrow = 4), horiz = TRUE, axes = FALSE, col = rainbow(4), names.arg = colnames(SM_midterm.tbl), las = 1, legend.text = rownames(SM_midterm.tbl), "topright", inset = c(-0.2, 0))
